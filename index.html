<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Aluno - Biblioteca</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div style="background-color: #333; padding: 10px; text-align: center; display: flex; justify-content: center; gap: 20px; position: fixed; top: 0; width: 100%;">
  <a href="index.html" style="color: white; text-decoration: none; font-size: 16px; padding: 8px 12px; background-color: #555; border-radius: 5px;">üìö Cadastrar Aluno</a>
  <a href="busca.php" style="color: white; text-decoration: none; font-size: 16px; padding: 8px 12px; background-color: #555; border-radius: 5px;">üîç Buscar Aluno</a>
</div>

<div class="container" style="margin-top: 60px;">
  <table class="topo">
    <tr>
      <td><img src="img/barbosa.png" alt=""></td>
      <td class="cada"><h2>Cadastrar Aluno üìñ</h2></td>
    </tr>
  </table>
  <form action="processar-dados.php" method="post">
    <table>
      <tr>
        <td><label for="codigo">C√≥digo do Aluno</label></td>
        <td><input name="codigo" id="codigo" class="readonly" readonly></td>
      </tr>
      <tr>
        <td><label for="cgm">CGM</label></td>
        <td><input type="text" name="cgm" id="cgm" maxlength="10" onkeypress="return apenasNumeros(event)" required>
</td>
      </tr>
      <tr>
        <td><label for="nome">Nome</label></td>
        <td><input name="nome" id="nome" required></td>
      </tr>
      <tr>
        <td><label for="email">E-mail</label></td>
        <td><input name="email" id="email" onblur="validarEmail(event)" required></td>
      </tr>
      <tr>
        <td><label for="celular">Celular</label></td>
        <td><input name="celular" id="celular" maxlength="15" placeholder="(XX) XXXXX-XXXX" oninput="mascararCelular(event)" onblur="validarCelular(event)" required>
<p id="mensagemErro"></p>

</td>
      </tr>
      <tr>
        <td><label for="serie">S√©rie</label></td>
        <td>
          <select id="serie" name="serie" required>
            <option value="">Selecione a s√©rie</option>
            <option value="1¬∫ Ano">1¬∫ Ano</option>
            <option value="2¬∫ Ano">2¬∫ Ano</option>
            <option value="3¬∫ Ano">3¬∫ Ano</option>
          </select>
        </td>
      </tr>
      <tr>
        <td><label for="turma">Turma</label></td>
        <td>
          <select id="turma" name="turma" required>
            <option value="">Selecione a turma</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="DS">Desenvolvimento de Sistemas</option>
            <option value="FD">Forma√ß√£o de Docentes</option>
            <option value="EST">Est√©tica</option>
            <option value="ADM">Administra√ß√£o</option>
            <option value="ENF">Enfermagem</option>
          </select>
        </td>
      </tr>
      <tr>
        <td><label for="cep">CEP</label></td>
        <td><input type="text" name="cep" id="cep" maxlength="9" placeholder="xxxxx-xxx" onblur="buscarEndereco()" required>
</td>
      </tr>
      <tr>
        <td><label for="endereco">Endere√ßo</label></td>
        <td><input name="endereco" type="text" id="endereco" required></td>
      </tr>
      <tr>
        <td><label for="bairro">Bairro</label></td>
        <td><input name="bairro" type="text" id="bairro" required></td>
      </tr>
      <tr>
        <td><label for="cidade">Cidade</label></td>
        <td><input name="cidade" type="text" id="cidade" required></td>
      </tr>
      <tr>
        <td><label for="estado">Estado</label></td>
        <td><input name="estado" type="text" id="estado" required></td>
      </tr>
    </table>
    <div class="botao-container">
      <button type="submit">‚úÖ Cadastrar</button>
    </div>
  </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("codigo").value = Math.floor(Math.random() * 1000000000);
});

function validarEmail(event) {
  if (!event.target.value.includes("@")) {
    alert("‚ùå O e-mail deve conter '@'");
  }
}

function validarCelular(event) {
  let v = event.target.value.replace(/\D/g, "");
  let mensagemErro = document.getElementById("mensagemErro");

  if (v.length !== 11) {
    mensagemErro.textContent = "‚ùå O n√∫mero deve ter exatamente 11 d√≠gitos no formato (XX) XXXXX-XXXX.";
    mensagemErro.style.color = "red";
  } else {
    mensagemErro.textContent = ""; // Limpa a mensagem quando v√°lido
  }
}




function apenasNumeros(event) {
  const char = String.fromCharCode(event.keyCode);
  if (!/[0-9]/.test(char)) {
    event.preventDefault();
    return false;
  }
  return true;
}

async function buscarEndereco() {
  const cep = document.getElementById("cep").value.replace(/\D/g, "");
  if (cep.length !== 8) {
    alert("‚ùå CEP inv√°lido! Insira um CEP com 8 n√∫meros.");
    return;
  }

  try {
    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
    const data = await response.json();

    if (data.erro) {
      alert("‚ùå CEP n√£o encontrado!");
      return;
    }

    document.getElementById("endereco").value = data.logradouro || "";
    document.getElementById("bairro").value = data.bairro || "";
    document.getElementById("cidade").value = data.localidade || "";
    document.getElementById("estado").value = data.uf || "";

    alert("‚úÖ Endere√ßo preenchido automaticamente!");
  } catch (error) {
    alert("‚ùå Erro ao buscar CEP. Tente novamente.");
  }
}


</script>

</body>
</html>
